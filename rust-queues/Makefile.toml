extend = [
    {path = "./makefiles/env.toml"},
    {path = "./makefiles/utils.toml"},
    {path = "./makefiles/benchmarks.toml"},
    {path = "./makefiles/plots.toml"},
]

# Build whole project
[tasks.build]
dependencies = ["build-rust-queues", "build-c-msq", "build-c-lprq"]

# Clean whole project
[tasks.clean]
dependencies = ["clean-rust-queues", "clean-c-msq", "clean-c-lprq"]

# Commands for MSQ Pairwise benchmarks
[tasks.benchmark-pairwise-msq]
description = "Parameter scan over threads for pairwise MSQ"
dependencies = ["pairwise-msq-c", "pairwise-msq-rust"]

# Command for MSQ Pairwise benchmarks
[tasks.benchmark-msq]
description = "All benchmarks for MSQ"
dependencies = ["benchmark-pairwise-msq"]

# Commands for LPRQ Pairwise benchmarks
[tasks.benchmark-pairwise-lprq]
description = "Parameter scan over threads for pairwise LPRQ"
dependencies = ["pairwise-lprq-c", "pairwise-lprq-rust"]

# Commands for individual LPRQ MPMC ratios
[tasks.benchmark-mpmc-lprq-1-1]
description = "LPRQ benchmark MPMC 1:1 ratio"
dependencies = ["mpmc-lprq-c-1-1", "mpmc-lprq-rust-1-1"]
[tasks.benchmark-mpmc-lprq-2-1]
description = "LPRQ benchmark MPMC 2:1 ratio"
dependencies = ["mpmc-lprq-c-2-1", "mpmc-lprq-rust-2-1"]

# Command for all LPRQ MPMC ratios
[tasks.benchmark-mpmc-lprq]
description = "MSQ benchmark MPM all ratios"
dependencies = ["benchmark-mpmc-lprq-1-1", "benchmark-mpmc-lprq-2-1"]

# Command for LPRQ Pairwise and MPMC benchmarks
[tasks.benchmark-lprq]
description = "All benchmarks for LPRQ"
dependencies = ["benchmark-pairwise-lprq", "benchmark-mpmc-lprq"]

# Run all benchmarks for all queues
[tasks.benchmark-all]
description = "All benchmarks for all queues"
dependencies = ["benchmark-msq", "benchmark-lprq"]

# Command for MSQ Pairwise and MPMC graphs
[tasks.graph-msq]
description = "All graphs for MSQ"
dependencies = ["graph-pairwise-msq"]

# Command for LPRQ Pairwise and MPMC graphs
[tasks.graph-lprq]
description = "All graphs for LPRQ"
dependencies = ["graph-pairwise-lprq", "graph-mpmc-lprq"]

# Commands to benchmark energy consumption for mpmc ratios
[tasks.benchmark-energy-1-1]
dependencies = ["energy-c-1-1", "energy-rust-1-1"]
[tasks.benchmark-energy-2-1]
dependencies = ["energy-c-2-1", "energy-rust-2-1"]

# Commands for congestion benchmarks
[tasks.benchmark-congestion-pairwise]
dependencies = ["congestion-pairwise-c", "congestion-pairwise-rust"]
[tasks.benchmark-congestion-mpmc-1-1]
dependencies = ["congestion-mpmc-c-1-1", "congestion-mpmc-rust-1-1"]
[tasks.benchmark-congestion-mpmc-2-1]
dependencies = ["congestion-mpmc-c-2-1", "congestion-mpmc-rust-2-1"]

# Command to graph congestions
[tasks.graph-congestions]
dependencies = ["graph-congestion-pw", "graph-congestion-mpmc-1-1", "graph-congestion-mpmc-2-1"]

# Generate all graphs
[tasks.graph-all]
description = "Graphs for all benchmarks"
dependencies = ["graph-msq", "graph-lprq", "graph-congestions"]

# Tasks that generate the graph after a sucessful benchmark in both C and Rust.
[tasks.pw-msq]
dependencies = ["benchmark-pairwise-msq", "graph-pairwise-msq"]
[tasks.pw-lprq]
dependencies = ["benchmark-pairwise-lprq", "graph-pairwise-lprq"]
[tasks.mpmc-lprq-1-1]
dependencies = ["benchmark-mpmc-lprq-1-1", "graph-mpmc-lprq-1-1"]
[tasks.mpmc-lprq-2-1]
dependencies = ["benchmark-mpmc-lprq-2-1", "graph-mpmc-lprq-2-1"]
[tasks.pw-congestion]
dependencies = ["benchmark-congestion-pairwise", "graph-congestion-pw"]
[tasks.mpmc-congestion-1-1]
dependencies = ["benchmark-congestion-mpmc-1-1", "graph-congestion-mpmc-1-1"]
[tasks.mpmc-congestion-2-1]
dependencies = ["benchmark-congestion-mpmc-2-1", "graph-congestion-mpmc-2-1"]

# No graphs on this one
[tasks.energy]
dependencies = ["benchmark-energy-1-1", "benchmark-energy-2-1"]

# Run all benchmarks and generate all graphs
[tasks.run]
description = "Run all benchmarks and generate all graphs"
dependencies = ["pw-msq", "pw-lprq", "mpmc-lprq-1-1", "mpmc-lprq-2-1", "pw-congestion", "mpmc-congestion-1-1", "mpmc-congestion-2-1", "energy"]